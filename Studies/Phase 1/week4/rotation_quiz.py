"""
Phase 1 - Week 4: 회전 표현 퀴즈
================================
회전 행렬, 오일러 각, 쿼터니언 개념 확인

사용법:
1. 먼저 문제를 읽고 직접 풀어보세요
2. 답을 확인하려면 파일 하단의 "답안" 섹션을 참고하세요
"""

import numpy as np
np.set_printoptions(precision=4, suppress=True)

print("=" * 60)
print("Phase 1 - Week 4: 회전 표현 퀴즈")
print("=" * 60)

# ============================================================
# 주관식 문제
# ============================================================

print("\n" + "=" * 60)
print("📝 주관식 문제")
print("=" * 60)

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 1: 회전 행렬 성질

회전 행렬 R에 대해 다음을 답하세요:

질문 1-1: R^T @ R = ?
질문 1-2: det(R) = ?
질문 1-3: R의 역행렬은 무엇과 같은가?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 2: 2D 회전

평면에서 점 (1, 0)을 원점 기준 90도 반시계방향 회전시키면?

질문: 결과 좌표는?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 3: 회전 순서

Rx(30°) @ Rz(45°) 와 Rz(45°) @ Rx(30°)의 결과가 같은가?

질문 3-1: 같은가 다른가?
질문 3-2: 왜 그런가?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 4: 오일러 각

Roll-Pitch-Yaw 각각 어떤 축의 회전인가?

질문: Roll=?, Pitch=?, Yaw=? (X/Y/Z 중 택)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 5: 짐벌락

질문 5-1: 짐벌락은 어떤 상황에서 발생하는가?
질문 5-2: 짐벌락이 발생하면 어떤 문제가 생기는가?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 6: 쿼터니언 기본

단위 쿼터니언 q = (w, x, y, z)에 대해:

질문 6-1: 단위 쿼터니언의 조건은?
질문 6-2: 항등 쿼터니언 (회전 없음)의 값은?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 7: 축-각 → 쿼터니언

Z축 기준 180도 회전을 쿼터니언으로 표현하면?

힌트: q = (cos(θ/2), sin(θ/2)*nx, sin(θ/2)*ny, sin(θ/2)*nz)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 8: 쿼터니언 역회전

쿼터니언 q로 회전한 것을 되돌리려면 어떤 쿼터니언을 사용?

질문: q의 역원 = ?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 9: SLERP

SLERP가 선형 보간(LERP)보다 좋은 이유는?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

# ----------------------------------------------------------
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔢 문제 10: SLAM 활용

VINS-Fusion이 오일러 각 대신 쿼터니언을 사용하는 이유 2가지는?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")


# ============================================================
# 답안 (스크롤)
# ============================================================








print("\n" + "=" * 60)
print("📋 답안")
print("=" * 60)

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 1: 회전 행렬 성질

1-1: R^T @ R = I (단위행렬)
1-2: det(R) = 1
1-3: R⁻¹ = R^T (역행렬 = 전치행렬)

→ 회전 행렬은 직교 행렬이며 det=1 (SO(3) 그룹)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 2: 2D 회전

답: (0, 1)

cos(90°)=0, sin(90°)=1
R @ [1,0]^T = [0,1]^T
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 3: 회전 순서

3-1: 다르다
3-2: 회전은 교환법칙이 성립하지 않음 (비가환)
     - 행렬 곱셈은 일반적으로 AB ≠ BA
     - 회전은 순서에 따라 결과가 달라짐
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 4: 오일러 각

Roll = X축 (좌우 기울임)
Pitch = Y축 (앞뒤 기울임)
Yaw = Z축 (좌우 방향)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 5: 짐벌락

5-1: Pitch = ±90°일 때 발생

5-2: 문제점:
     - 자유도 3 → 2로 감소
     - Roll과 Yaw가 동일한 축 효과
     - 특정 방향 제어 불가
     - 값의 급격한 불연속
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 6: 쿼터니언 기본

6-1: w² + x² + y² + z² = 1 (노름 = 1)

6-2: 항등 쿼터니언 = (1, 0, 0, 0)
     → 회전 각도 0, cos(0/2)=1
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 7: 축-각 → 쿼터니언

q = (cos(90°), sin(90°)*0, sin(90°)*0, sin(90°)*1)
  = (0, 0, 0, 1)

풀이: θ/2 = 90°, cos(90°)=0, sin(90°)=1
      축 = (0, 0, 1)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 8: 쿼터니언 역회전

답: 켤레 쿼터니언 q* = (w, -x, -y, -z)

단위 쿼터니언의 경우: q⁻¹ = q*
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 9: SLERP

SLERP의 장점:
1. 일정한 각속도 유지 (균일한 보간)
2. 항상 단위 쿼터니언 유지
3. 최단 경로로 회전
4. LERP는 중간에 속도가 변함
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 10: SLAM 활용

VINS-Fusion이 쿼터니언을 사용하는 이유:

1. 짐벌락 없음
   - 모든 방향에서 안정적 표현
   - 카메라가 어디를 보든 문제없음

2. IMU 적분에 적합
   - 각속도 → 쿼터니언 적분이 자연스러움
   - 오일러 각은 불연속 발생 가능

추가:
- SLERP로 부드러운 보간
- 정규화 제약 하나만 관리
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("\n" + "=" * 60)
print("📊 자가 채점")
print("=" * 60)
print("""
각 문제당 10점, 총 100점

✅ 10문제 모두 맞춤: 완벽! Week 5로 진행
✅ 7-9문제: 잘하고 있어요, 복습 후 진행
⚠️ 4-6문제: 영상 다시 시청 권장
❌ 0-3문제: rotation_basics.py 다시 공부

💡 SLAM 관련 문제 (5, 10)이 특히 중요합니다!
""")
