"""
Phase 1 - Week 5: SE(3) 퀴즈
============================
강체 변환 개념 확인 퀴즈

README.md의 Part 1~5 내용에 맞춰 구성되어 있습니다.

사용법:
1. 먼저 문제를 읽고 직접 풀어보세요 ✏️
2. 코드를 실행하면 문제 → 스크롤 → 답안 순으로 나옵니다
3. 각 문제당 10점, 총 100점

💡 팁: se3_basics.py를 먼저 실습하고 푸세요!
"""

import numpy as np
np.set_printoptions(precision=4, suppress=True)

print("=" * 60)
print("Phase 1 - Week 5: SE(3) 퀴즈")
print("=" * 60)

# ============================================================
# Part 1 관련 문제: SE(3) 변환 행렬
# ============================================================

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 [Part 1] SE(3) 변환 행렬
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 1: SE(3) 구조                                     │
├──────────────────────────────────────────────────────────┤
│ 4×4 SE(3) 변환 행렬 T의 각 부분이 무엇인지 답하세요.      │
│                                                          │
│     T = [ ?  | ? ]                                       │
│         [----+---]                                       │
│         [ ?  | ? ]                                       │
│                                                          │
│ 각 칸에 들어갈 것과 크기를 적으세요.                     │
└──────────────────────────────────────────────────────────┘
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 2: SE(3)의 자유도 (DOF)                           │
├──────────────────────────────────────────────────────────┤
│ SE(3) 변환의 자유도는 몇 개인가?                         │
│                                                          │
│ • 회전:     ? DOF (구체적으로 어떤 축?)                  │
│ • 평행이동: ? DOF                                        │
│ • 총합:     ? DOF                                        │
└──────────────────────────────────────────────────────────┘
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 3: SE(3)와 SO(3)의 관계                           │
├──────────────────────────────────────────────────────────┤
│ 다음 중 올바른 것을 모두 고르세요:                       │
│                                                          │
│ a) SO(3)는 3×3 행렬, SE(3)는 4×4 행렬이다               │
│ b) SE(3) ⊂ SO(3) 이다                                   │
│ c) t=0이면 SE(3)는 순수 회전(SO(3))과 같다              │
│ d) SE(3)에서 회전은 평행이동보다 먼저 적용된다          │
└──────────────────────────────────────────────────────────┘
""")

# ============================================================
# Part 2 관련 문제: 동차 좌표
# ============================================================

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 [Part 2] 동차 좌표
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 4: 좌표 변환                                      │
├──────────────────────────────────────────────────────────┤
│ 다음을 변환하세요:                                       │
│                                                          │
│ (a) 3D 점 (2, 3, 5) → 동차 좌표 ?                       │
│ (b) 동차 좌표 (8, 4, 12, 2) → 3D 점 ?                   │
└──────────────────────────────────────────────────────────┘
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 5: 동차 좌표의 장점                               │
├──────────────────────────────────────────────────────────┤
│ 동차 좌표를 사용하면 어떤 장점이 있는지 2가지 답하세요.  │
│                                                          │
│ 힌트: 일반 좌표로 변환하려면 p' = R @ p + t              │
│       동차 좌표로 변환하려면 p' = T @ p                  │
└──────────────────────────────────────────────────────────┘
""")

# ============================================================
# Part 3 관련 문제: 변환 연산
# ============================================================

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 [Part 3] 변환 연산
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 6: 변환 합성                                      │
├──────────────────────────────────────────────────────────┤
│ T1, T2가 순서대로 적용될 때, 합성 행렬은?                │
│                                                          │
│ a) T1 @ T2                                               │
│ b) T2 @ T1                                               │
│ c) T1 + T2                                               │
│ d) T1 * T2 (element-wise)                                │
│                                                          │
│ 또한, 왜 T1 @ T2 ≠ T2 @ T1 인가?                        │
└──────────────────────────────────────────────────────────┘
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 7: 역변환 공식                                    │
├──────────────────────────────────────────────────────────┤
│ T = [R|t]의 역변환 T⁻¹의 공식을 적으세요.               │
│                                                          │
│ T⁻¹ = [ ?  | ?     ]                                    │
│       [----+-------]                                     │
│       [ ?  | ?     ]                                     │
│                                                          │
│ 추가 질문:                                               │
│ • 왜 R의 역변환은 R^T인가?                              │
│ • 왜 t의 역변환은 단순히 -t가 아닌가?                   │
└──────────────────────────────────────────────────────────┘
""")

# ============================================================
# Part 4 관련 문제: 좌표계 변환
# ============================================================

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 [Part 4] 좌표계 변환
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 8: T 표기법                                       │
├──────────────────────────────────────────────────────────┤
│ T_ab가 의미하는 것을 두 가지 관점에서 설명하세요:        │
│                                                          │
│ (1) 포즈 관점: T_ab = ?                                  │
│ (2) 변환 관점: T_ab @ p_b = ?                           │
└──────────────────────────────────────────────────────────┘
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 9: 월드 ↔ 카메라 변환                             │
├──────────────────────────────────────────────────────────┤
│ T_wc가 카메라의 포즈 (월드 기준)일 때,                   │
│ 월드 좌표의 점 P_world를 카메라 좌표로 변환하려면?       │
│                                                          │
│ P_camera = ? @ P_world                                   │
└──────────────────────────────────────────────────────────┘
""")

print("""
┌──────────────────────────────────────────────────────────┐
│ 🔢 문제 10: 상대 포즈                                     │
├──────────────────────────────────────────────────────────┤
│ 키프레임 i, j의 월드 포즈가 T_wi, T_wj일 때,             │
│ i 기준 j의 상대 포즈 T_ij는?                             │
│                                                          │
│ T_ij = ?                                                 │
│                                                          │
│ 힌트: 아래첨자를 연결해서 생각해보세요!                  │
│       T_i? @ T_?j = T_ij                                 │
└──────────────────────────────────────────────────────────┘
""")


# ============================================================
# 답안 확인 (스크롤 다운!)
# ============================================================

print("""




━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
                    ⬇️ 답안 확인 ⬇️
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━




""")

print("\n" + "=" * 60)
print("📋 답안")
print("=" * 60)

# ----- Part 1 답안 -----
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 1: SE(3) 구조
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    T = [ R  | t ]
        [----+---]
        [ 0  | 1 ]

    • R: 3×3 회전 행렬 (SO(3)에 속함)
    • t: 3×1 평행이동 벡터
    • 0: 1×3 영 벡터 [0, 0, 0]
    • 1: 스칼라 1 (동차 좌표 유지)
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 2: SE(3)의 자유도
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    • 회전:     3 DOF (roll/x축, pitch/y축, yaw/z축)
    • 평행이동: 3 DOF (x, y, z)
    • 총합:     6 DOF

    → "6-DOF 포즈 추정" = 이 6개 값을 추정한다는 의미!
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 3: SE(3)와 SO(3)의 관계
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    정답: a), c), d)

    a) ✅ SO(3)는 3×3, SE(3)는 4×4 맞음
    b) ❌ SO(3) ⊂ SE(3) (SO(3)가 SE(3)에 포함됨)
    c) ✅ t=0이면 순수 회전과 같음
    d) ✅ p' = R @ p + t (회전 먼저, 이동 나중)
""")

# ----- Part 2 답안 -----
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 4: 좌표 변환
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    (a) (2, 3, 5) → (2, 3, 5, 1)
        마지막에 1을 추가

    (b) (8, 4, 12, 2) → (4, 2, 6)
        마지막 값(w=2)으로 모두 나누기
        8/2=4, 4/2=2, 12/2=6
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 5: 동차 좌표의 장점
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    1. 회전+평행이동을 행렬 곱 하나로 처리
       (일반 좌표: R @ p + t, 동차 좌표: T @ p)

    2. 연속 변환이 행렬 곱 체인으로 간단화
       (T_total = T3 @ T2 @ T1)

    3. (추가) 카메라 투영도 행렬 곱으로 표현 가능
    4. (추가) 무한원점(방향)을 w=0으로 표현 가능
""")

# ----- Part 3 답안 -----
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 6: 변환 합성
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    정답: b) T2 @ T1

    먼저 T1, 다음 T2 적용 → T2 @ T1
    (행렬은 오른쪽에서 왼쪽으로 적용됨)

    왜 T1 @ T2 ≠ T2 @ T1인가?
    → 행렬 곱셈은 교환법칙이 성립하지 않음!
    → "90도 회전 후 이동" ≠ "이동 후 90도 회전"
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 7: 역변환 공식
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    T⁻¹ = [ R^T  | -R^T @ t ]
          [------+----------]
          [  0   |    1     ]

    왜 R⁻¹ = R^T인가?
    → R은 직교 행렬(Orthogonal Matrix)이므로
    → R^T @ R = I → R⁻¹ = R^T

    왜 단순히 -t가 아닌가?
    → 순변환: 회전 → 이동
    → 역변환: 이동 취소 → 역회전 (역순!)
    → 이동을 취소할 때도 회전의 영향을 받음
    → 따라서 -R^T @ t
""")

# ----- Part 4 답안 -----
print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 8: T 표기법
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    (1) 포즈 관점: T_ab = "a 좌표계에서 본 b의 포즈"

    (2) 변환 관점: T_ab @ p_b = p_a
                  "b 좌표계의 점을 a 좌표계로 변환"

    💡 외우는 팁: 아래첨자가 상쇄됨!
       T_ab @ p_b = p_a  (b가 상쇄되어 a만 남음)
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 9: 월드 ↔ 카메라 변환
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    P_camera = T_cw @ P_world
             = T_wc⁻¹ @ P_world

    월드 → 카메라 변환은 카메라 포즈의 역변환!

    풀이:
    T_cw @ p_w = p_c (아래첨자: w가 상쇄 → c만 남음)
""")

print("""
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 답 10: 상대 포즈
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    T_ij = T_wi⁻¹ @ T_wj
         = T_iw @ T_wj

    아래첨자 연결:
    T_iw @ T_wj = T_ij  (w가 상쇄!)

    해석: i 좌표계에서 본 j의 위치와 방향

    💡 역변환도 아래첨자 뒤집기:
       T_ji = T_ij⁻¹
""")

# ============================================================
# 채점
# ============================================================
print("\n" + "=" * 60)
print("📊 자가 채점")
print("=" * 60)
print("""
┌──────────────────────────────────────────────────────────┐
│ 각 문제당 10점, 총 100점                                  │
├──────────────────────────────────────────────────────────┤
│ ✅ 90-100점: 완벽! Week 6 Lie 군/대수로 진행             │
│ ✅ 70-89점:  잘하고 있어요. 틀린 부분 복습 후 진행       │
│ ⚠️ 50-69점:  se3_basics.py 다시 실습 권장                │
│ ❌ 0-49점:   README.md부터 차근차근 복습                 │
├──────────────────────────────────────────────────────────┤
│ 💡 핵심 문제: 문제 7(역변환), 문제 10(상대포즈)          │
│    → 이 두 개는 SLAM에서 매우 자주 사용됩니다!          │
└──────────────────────────────────────────────────────────┘

🎯 다음 단계: Week 6 - Lie 군/대수 기초
   • SE(3)가 왜 over-parameterized인지
   • se(3) 접선 공간이란?
   • 최적화에서의 활용
""")
